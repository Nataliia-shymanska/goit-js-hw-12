{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["'use strict';\n\nconst refs = {\n  imageSearchForm: document.querySelector('.image-search-form'),\n  imageSearchInput: document.querySelector('.image-search-input'),\n  submitButton: document.querySelector('.image-search-btn'),\n  imageList: document.querySelector('.image-gallery'),\n};\n\nfunction imagesTemplate(image) {\n  return `<li class=\"image-gallery-item\">\n  <a class=\"img-link\" href=${image.largeImageURL} onclick=\"event.preventDefault()\"><img class=\"img\" src=${image.webformatURL} alt=${image.tags}></img></a>\n   <ul class=\"img-dscr\">\n      <li class=\"img-data\">\n        <p class=\"img-data-title\">Likes</p>\n        <p class=\"img-data-numbers\">${image.likes}</p>\n      </li>\n      <li class=\"img-data\">\n        <p class=\"img-data-title\">Views</p>\n        <p class=\"img-data-numbers\">${image.views}</p>\n      </li>\n      <li class=\"img-data\">\n        <p class=\"img-data-title\">Comments</p>\n        <p class=\"img-data-numbers\">${image.comments}</p>\n      </li>\n      <li class=\"img-data\">\n        <p class=\"img-data-title\">Downloads</p>\n        <p class=\"img-data-numbers\">${image.downloads}</p>\n      </li>\n    </ul>\n</li>`;\n}\n\nexport function renderImages(images) {\n  return images.map(imagesTemplate).join('\\n');\n}\n","'use strict';\nimport axios from 'axios';\n\nexport async function getImages(request, page, per_page) {\n  try {\n    const imagesApi = axios.create({\n      baseURL: 'https://pixabay.com',\n    });\n    const res = await imagesApi.get('/api/', {\n      params: {\n        key: '44319460-4af2fb7eeaa8b0840083a4a49',\n        q: request,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: per_page,\n      },\n    });\n\n    return res.data;\n  } catch (error) {\n    console.log(enterError('', 'api get error'));\n  }\n}\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { renderImages } from './js/render-functions';\nimport { getImages } from './js/pixabay-api';\n\nconst refs = {\n  imageSearchForm: document.querySelector('.image-search-form'),\n  imageSearchInput: document.querySelector('.image-search-input'),\n  submitButton: document.querySelector('.image-search-btn'),\n  imageList: document.querySelector('.image-gallery'),\n  loader: document.querySelector('.image-loader'),\n  more: document.querySelector('.load-more-btn'),\n  upBtn: document.querySelector('.up-button'),\n};\n\nlet request;\nlet page = 1;\nlet maxPage = 1;\nconst per_page = 15;\n\nconst lightbox = new SimpleLightbox('.image-gallery-item a', {\n  captions: true,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  animationSpeed: 300,\n  widthRatio: 1,\n  heightRatio: 0.95,\n  disableRightClick: true,\n});\n\nrefs.imageSearchForm.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  request = e.target.elements.userData.value.trim();\n  page = 1;\n\n  if (!request) {\n    refs.imageList.innerHTML = '';\n    hideMoreBtn();\n    hideLoader();\n    return iziToast.info({\n      message: 'You need to enter search request!',\n      position: 'topRight',\n      transitionIn: 'bounceInDown',\n      transitionOut: 'fadeOutDown',\n    });\n  }\n\n  showLoader();\n  hideMoreBtn();\n\n  try {\n    const data = await getImages(request, page, per_page);\n    if (data.hits.length === 0) {\n      refs.imageList.innerHTML = '';\n      hideLoader();\n      return iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        transitionIn: 'bounceInDown',\n        transitionOut: 'fadeOutDown',\n      });\n    }\n\n    const markup = renderImages(data.hits);\n    refs.imageList.innerHTML = markup;\n\n    maxPage = Math.ceil(data.totalHits / per_page);\n\n    lightbox.refresh();\n    checkBtnStatus();\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred. Please try again later.',\n      position: 'topRight',\n      transitionIn: 'bounceInDown',\n      transitionOut: 'fadeOutDown',\n    });\n  } finally {\n    hideLoader();\n  }\n\n  e.target.reset();\n});\n\nrefs.more.addEventListener('click', async () => {\n  page++;\n  showLoader();\n  hideMoreBtn();\n\n  try {\n    const data = await getImages(request, page, per_page);\n    const markup = renderImages(data.hits);\n    refs.imageList.insertAdjacentHTML('beforeend', markup);\n\n    skipPrewElem();\n    lightbox.refresh();\n    checkBtnStatus();\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred. Please try again later.',\n      position: 'topRight',\n      transitionIn: 'bounceInDown',\n      transitionOut: 'fadeOutDown',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\nfunction checkBtnStatus() {\n  if (page >= maxPage) {\n    hideMoreBtn();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n      transitionIn: 'bounceInDown',\n      transitionOut: 'fadeOutDown',\n    });\n  } else {\n    showMoreBtn();\n  }\n}\n\nfunction skipPrewElem() {\n  const height = refs.imageList.children[0].getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction showLoader() {\n  refs.loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  refs.loader.style.display = 'none';\n}\n\nfunction showMoreBtn() {\n  refs.more.style.display = 'block';\n}\n\nfunction toTheTop() {\n  refs.imageSearchForm.scrollIntoView({ behavior: 'smooth' });\n  refs.upBtn.setAttribute('hidden', '');\n}\n\nfunction hideMoreBtn() {\n  refs.more.style.display = 'none';\n}\n\nfunction checkScroll() {\n  if (window.scrollY >= 50) {\n    refs.upBtn.removeAttribute('hidden');\n  } else {\n    refs.upBtn.setAttribute('hidden', '');\n  }\n}\n\nwindow.addEventListener('scroll', checkScroll);\nrefs.upBtn.addEventListener('click', toTheTop);\n"],"names":["imagesTemplate","image","renderImages","images","getImages","request","page","per_page","axios","refs","maxPage","lightbox","SimpleLightbox","hideMoreBtn","hideLoader","iziToast","showLoader","data","markup","checkBtnStatus","skipPrewElem","showMoreBtn","height","toTheTop","checkScroll"],"mappings":"+vBAGmB,SAAS,cAAc,oBAAoB,EAC1C,SAAS,cAAc,qBAAqB,EAChD,SAAS,cAAc,mBAAmB,EAC7C,SAAS,cAAc,gBAAgB,EAGpD,SAASA,EAAeC,EAAO,CAC7B,MAAO;AAAA,6BACoBA,EAAM,aAAa,0DAA0DA,EAAM,YAAY,QAAQA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA,sCAIxGA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,sCAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,sCAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,sCAIdA,EAAM,SAAS;AAAA;AAAA;AAAA,MAIrD,CAEO,SAASC,EAAaC,EAAQ,CACnC,OAAOA,EAAO,IAAIH,CAAc,EAAE,KAAK;AAAA,CAAI,CAC7C,CChCO,eAAeI,EAAUC,EAASC,EAAMC,EAAU,CACvD,GAAI,CAgBF,OAZY,MAHMC,EAAM,OAAO,CAC7B,QAAS,qBACf,CAAK,EAC2B,IAAI,QAAS,CACvC,OAAQ,CACN,IAAK,qCACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUC,CACX,CACP,CAAK,GAEU,IACZ,MAAe,CACd,QAAQ,IAAI,WAAW,GAAI,eAAe,CAAC,CAC5C,CACH,CCbA,MAAME,EAAO,CACX,gBAAiB,SAAS,cAAc,oBAAoB,EAC5D,iBAAkB,SAAS,cAAc,qBAAqB,EAC9D,aAAc,SAAS,cAAc,mBAAmB,EACxD,UAAW,SAAS,cAAc,gBAAgB,EAClD,OAAQ,SAAS,cAAc,eAAe,EAC9C,KAAM,SAAS,cAAc,gBAAgB,EAC7C,MAAO,SAAS,cAAc,YAAY,CAC5C,EAEA,IAAIJ,EACAC,EAAO,EACPI,EAAU,EACd,MAAMH,EAAW,GAEXI,EAAW,IAAIC,EAAe,wBAAyB,CAC3D,SAAU,GACV,gBAAiB,MACjB,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,aAAc,IACd,eAAgB,IAChB,WAAY,EACZ,YAAa,IACb,kBAAmB,EACrB,CAAC,EAEDH,EAAK,gBAAgB,iBAAiB,SAAU,MAAM,GAAK,CAMzD,GALA,EAAE,eAAc,EAEhBJ,EAAU,EAAE,OAAO,SAAS,SAAS,MAAM,OAC3CC,EAAO,EAEH,CAACD,EACH,OAAAI,EAAK,UAAU,UAAY,GAC3BI,IACAC,IACOC,EAAS,KAAK,CACnB,QAAS,oCACT,SAAU,WACV,aAAc,eACd,cAAe,aACrB,CAAK,EAGHC,IACAH,IAEA,GAAI,CACF,MAAMI,EAAO,MAAMb,EAAUC,EAASC,EAAMC,CAAQ,EACpD,GAAIU,EAAK,KAAK,SAAW,EACvB,OAAAR,EAAK,UAAU,UAAY,GAC3BK,IACOC,EAAS,MAAM,CACpB,QACE,2EACF,SAAU,WACV,aAAc,eACd,cAAe,aACvB,CAAO,EAGH,MAAMG,EAAShB,EAAae,EAAK,IAAI,EACrCR,EAAK,UAAU,UAAYS,EAE3BR,EAAU,KAAK,KAAKO,EAAK,UAAYV,CAAQ,EAE7CI,EAAS,QAAO,EAChBQ,GACD,MAAe,CACdJ,EAAS,MAAM,CACb,QAAS,6CACT,SAAU,WACV,aAAc,eACd,cAAe,aACrB,CAAK,CACL,QAAY,CACRD,GACD,CAED,EAAE,OAAO,OACX,CAAC,EAEDL,EAAK,KAAK,iBAAiB,QAAS,SAAY,CAC9CH,IACAU,IACAH,IAEA,GAAI,CACF,MAAMI,EAAO,MAAMb,EAAUC,EAASC,EAAMC,CAAQ,EAC9CW,EAAShB,EAAae,EAAK,IAAI,EACrCR,EAAK,UAAU,mBAAmB,YAAaS,CAAM,EAErDE,IACAT,EAAS,QAAO,EAChBQ,GACD,MAAe,CACdJ,EAAS,MAAM,CACb,QAAS,6CACT,SAAU,WACV,aAAc,eACd,cAAe,aACrB,CAAK,CACL,QAAY,CACRD,GACD,CACH,CAAC,EAED,SAASK,GAAiB,CACpBb,GAAQI,GACVG,IACAE,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,aAAc,eACd,cAAe,aACrB,CAAK,GAEDM,GAEJ,CAEA,SAASD,GAAe,CACtB,MAAME,EAASb,EAAK,UAAU,SAAS,CAAC,EAAE,sBAAuB,EAAC,OAElE,OAAO,SAAS,CACd,IAAKa,EAAS,EACd,SAAU,QACd,CAAG,CACH,CAEA,SAASN,GAAa,CACpBP,EAAK,OAAO,MAAM,QAAU,OAC9B,CAEA,SAASK,GAAa,CACpBL,EAAK,OAAO,MAAM,QAAU,MAC9B,CAEA,SAASY,GAAc,CACrBZ,EAAK,KAAK,MAAM,QAAU,OAC5B,CAEA,SAASc,GAAW,CAClBd,EAAK,gBAAgB,eAAe,CAAE,SAAU,QAAU,CAAA,EAC1DA,EAAK,MAAM,aAAa,SAAU,EAAE,CACtC,CAEA,SAASI,GAAc,CACrBJ,EAAK,KAAK,MAAM,QAAU,MAC5B,CAEA,SAASe,GAAc,CACjB,OAAO,SAAW,GACpBf,EAAK,MAAM,gBAAgB,QAAQ,EAEnCA,EAAK,MAAM,aAAa,SAAU,EAAE,CAExC,CAEA,OAAO,iBAAiB,SAAUe,CAAW,EAC7Cf,EAAK,MAAM,iBAAiB,QAASc,CAAQ"}